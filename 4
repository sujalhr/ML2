import pandas as pd
import matplotlib.pyplot as plt
from sklearn.datasets import load_iris
from sklearn.cluster import KMeans
from sklearn.decomposition import PCA
from sklearn.metrics import mean_squared_error
import numpy as np

# Load dataset without target column
iris = load_iris()
X = pd.DataFrame(iris.data, columns=iris.feature_names)

# KMeans clustering
k = 3
kmeans = KMeans(n_clusters=k, random_state=42)
clusters = kmeans.fit_predict(X)

# Calculate MSE manually
centroids = kmeans.cluster_centers_
mse = mean_squared_error(X, centroids[clusters])
print(f"Mean Squared Error (MSE): {mse:.4f}")

# Visualize clusters using PCA
pca = PCA(n_components=2)
X_reduced = pca.fit_transform(X)

plt.figure(figsize=(8, 6))
for cluster_id in range(k):
    plt.scatter(X_reduced[clusters == cluster_id, 0],
                X_reduced[clusters == cluster_id, 1],
                label=f'Cluster {cluster_id}')

plt.title("K-Means Clustering (using pca)")
plt.xlabel("PCA Component 1")
plt.ylabel("PCA Component 2")
plt.legend()
plt.grid(True)
plt.show()

